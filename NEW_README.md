# HamsterDrive - Windows驱动管理工具

HamsterDrive是一个用于管理和维护Windows系统驱动程序的工具。它提供了完整的驱动程序生命周期管理功能，包括扫描、备份、恢复和更新驱动程序。

## 功能特性

### 1. 系统扫描
- 硬件组件检测
- 已安装驱动扫描
- 驱动更新状态检查

### 2. 驱动备份
- 驱动配置信息备份
- 可选的驱动文件备份
- 完整驱动备份（配置+文件）

### 3. 驱动恢复
- 从备份恢复驱动配置
- 从备份恢复驱动文件
- 完整驱动恢复

### 4. 驱动更新
- 检查驱动更新
- 自动/手动更新支持
- 连接真正的驱动更新服务器

### 5. 安全性
- 驱动签名验证
- 确保下载的驱动安全可靠

### 6. 用户界面
- 图形用户界面（使用egui）
- 清晰的操作按钮和状态显示

### 7. 错误处理
- 详细的错误处理机制
- 处理各种安装失败情况

## 项目结构

```
HamsterDrive/
├── src/
│   ├── main.rs           # 主入口点
│   ├── scan.rs           # 系统扫描模块
│   ├── backup.rs         # 驱动备份模块
│   ├── restore.rs        # 驱动恢复模块
│   ├── update.rs         # 驱动更新模块
│   ├── driver_db.rs      # 驱动数据库接口
│   ├── signature.rs      # 驱动签名验证
│   ├── error.rs          # 错误处理
│   ├── list.rs           # 驱动列表
│   └── gui.rs            # 图形界面
├── Cargo.toml            # 项目配置
└── README.md             # 项目说明
```

## 核心模块说明

### scan.rs - 系统扫描模块
负责扫描系统硬件组件和已安装的驱动程序。

### backup.rs - 驱动备份模块
提供驱动配置信息和文件的备份功能。

### restore.rs - 驱动恢复模块
从备份中恢复驱动程序。

### update.rs - 驱动更新模块
检查和安装驱动程序更新，支持自动和手动模式。

### driver_db.rs - 驱动数据库接口
连接到远程驱动数据库服务器，查询驱动更新信息。

### signature.rs - 驱动签名验证
验证驱动文件的数字签名，确保安全性。

### error.rs - 错误处理
统一的错误类型定义和处理。

### list.rs - 驱动列表
显示系统中已安装的驱动程序。

### gui.rs - 图形界面
使用egui创建的用户界面。

## 编译和运行

### 环境要求
- Rust 1.60或更高版本
- Windows系统（由于使用了Windows特定的API）
- Visual Studio 2017或更高版本，或Build Tools for Visual Studio（用于MSVC工具链）

### 编译步骤
```bash
# 克隆项目
git clone <repository-url>
cd HamsterDrive

# 构建项目
cargo build

# 运行项目
cargo run
```

### 解决编译问题
如果遇到链接器错误，请确保已安装Visual Studio或Build Tools for Visual Studio，并选择了C++开发工具。

对于MinGW工具链用户，可能需要安装额外的工具：
```bash
# 在MinGW环境中
pacman -S mingw-w64-x86_64-gcc
```

## 使用说明

1. 启动应用程序后，首先会验证示例驱动文件的签名。
2. 点击"扫描硬件"按钮扫描系统硬件组件。
3. 点击"驱动列表"按钮查看已安装的驱动程序。
4. 点击"检测驱动更新"按钮检查可用的驱动更新。
5. 点击"驱动备份"按钮备份当前驱动程序。
6. 点击"驱动恢复"按钮从备份恢复驱动程序。

## 安全性考虑

- 所有下载的驱动程序都会经过签名验证
- 备份文件存储在本地安全位置
- 更新过程提供自动和手动两种模式

## 未来改进方向

- 添加更多硬件检测功能
- 支持更多的驱动数据库
- 增强用户界面交互体验
- 添加日志记录功能
- 支持命令行界面

## 许可证

本项目采用MIT许可证。